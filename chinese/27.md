---
original: e07c3d6163ad0f2c899b4abc386229c1dd2d30c38b83cc28228a43fee7f3cbe6
---

NIP-27
======

文本注释引用
------------

`草案` `可选`

本文档规范化了客户端对任何在其 `.content` 中包含可读文本的事件（如类型 1 和 30023）内部引用其他事件和个人资料的处理方式。

在创建事件时，客户端应在 `.content` 中使用 [NIP-21](21.md) 代码（如 `nostr:nprofile1qqsw3dy8cpu...6x2argwghx6egsqstvg`）来包含对其他个人资料和事件的提及。

为每个引用包含 [NIP-10](10.md) 风格的标签（`["e", <十六进制id>, <中继URL>, <标记>]`）是可选的。当客户端希望被提及的个人资料收到提及通知，或希望被引用的事件将其提及识别为回复时，应该这样做。

接收到在 `.content` 中包含此类 `nostr:...` 提及的事件的阅读器客户端可以在处理过程中进行任何所需的上下文增强（例如，链接到个人资料或显示被提及事件内容的预览）。如果将此类提及转换为链接，它们可以成为内部链接、[NIP-21](21.md) 链接或直接链接到处理这些引用的网络客户端。

---

## 个人资料提及过程示例

假设 Bob 正在使用一个客户端写笔记，该客户端具有用户搜索和自动完成功能，当用户输入 `@` 字符时触发。

当 Bob 输入 `"hello @mat"` 时，客户端会提示他自动完成 [mattn 的个人资料](https://njump.me/npub1937vv2nf06360qn9y8el6d8sevnndy7tuh5nzre4gj05xc32tnwqauhaj6)，显示头像和名称。

Bob 按下"回车键"，现在他看到他输入的笔记显示为 `"hello @mattn"`，`@mattn` 被高亮显示，表示这是一个提及。然而，在内部，事件看起来是这样的：

```json
{
  "content": "hello nostr:nprofile1qqszclxx9f5haga8sfjjrulaxncvkfekj097t6f3pu65f86rvg49ehqj6f9dh",
  "created_at": 1679790774,
  "id": "f39e9b451a73d62abc5016cffdd294b1a904e2f34536a208874fe5e22bbd47cf",
  "kind": 1,
  "pubkey": "79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798",
  "sig": "f8c8bab1b90cc3d2ae1ad999e6af8af449ad8bb4edf64807386493163e29162b5852a796a8f474d6b1001cddbaac0de4392838574f5366f03cc94cf5dfb43f4d",
  "tags": [
    [
      "p",
      "2c7cc62a697ea3a7826521f3fd34f0cb273693cbe5e9310f35449f43622a5cdc"
    ]
  ]
}
```

（或者，提及也可以是 `nostr:npub1...` URL。）

Bob 发布这个事件后，当 Carol 看到它时，她的客户端最初会按原样显示 `.content`，但随后会解析 `.content` 并发现其中有一个 `nostr:` URL，解码它，从中提取公钥（可能还有中继提示），从其内部数据库或中继获取该个人资料，然后将完整的 URL 替换为名称 `@mattn`，并链接到该个人资料的内部页面视图。

## 详细且可能不必要的考虑

- 上面的例子非常具体，但这并不意味着所有客户端都必须实现相同的流程。可能有些客户端根本不支持自动完成，所以它们只允许用户将原始 [NIP-19](19.md) 代码粘贴到文本正文中，然后在发布事件之前在这些代码前加上 `nostr:`。
- 引用其他事件的流程类似：用户可以粘贴 `note1...` 或 `nevent1...` 代码，客户端会将其转换为 `nostr:note1...` 或 `nostr:nevent1...` URL。然后在读取这些引用时，客户端可能会在预览框中显示被引用的笔记或其他内容 —— 或者什么都不显示。
- 可以采用其他显示方式：例如，如果一个专门用于处理 `kind:1` 文本笔记的客户端在 `.content` 中看到 [`kind:30023`](23.md) `nostr:naddr1...` URL 引用，它可以决定将其转换为指向某个能够显示此类事件的硬编码网络应用的链接。
- 客户端可以给用户选择是否为提及的事件或个人资料包含标签的选项。如果有人想提及 `mattn` 但不通知他们，同时在他们的笔记中仍然有一个漂亮的可增强/可点击的链接指向他们的个人资料，他们可以指示他们的客户端不为该特定提及创建 `["p", ...]` 标签。
- 同样，如果有人想引用另一个笔记，但他们的引用并不意味着要与该笔记的其他回复一起显示，他们的客户端可以选择不为 `.content` 内的任何给定 `nostr:nevent1...` URL 包含相应的 `["e", ...]` 标签。客户端可以决定是否向用户公开这些高级功能，或者对这些事情持更固执己见的态度。