---
original: 76e7202d5bb2216d6732fd5f9747cfe8b559cab8b2bbc3b42370b20c14ab5cf5
---

NIP-52
======

日历事件
-------

`草案` `可选`

本规范定义了表示特定时刻或时刻之间发生的日历事件。这些日历事件是可参数化替换和可删除的，符合 [NIP-09](09.md) 的规定。

与本 NIP 特有的"日历事件"（calendar event）术语不同，"事件"（event）一词在所有 NIP 中广泛用于描述任何 Nostr 事件。在此特别区分这两个术语。

## 日历事件

有两种类型的日历事件，由不同的种类表示：基于日期的和基于时间的日历事件。日历事件不需要成为[日历](#日历)的一部分。

### 基于日期的日历事件

这种日历事件从一个日期开始，在未来的另一个日期之前结束。它适用于全天或多天事件，其中时间和时区没有重要意义。例如，周年纪念日、公共假期、假期等。

#### 格式

该格式使用参数化可替换事件种类 `31922`。

这些事件的 `.content` 应该是日历事件的详细描述。它是必需的，但可以是空字符串。

标签列表如下：
* `d`（必需）通用唯一标识符（UUID）。由创建日历事件的客户端生成。
* `title`（必需）日历事件的标题
* `start`（必需）包含开始日期，采用 ISO 8601 格式（YYYY-MM-DD）。必须小于 `end`（如果存在）。
* `end`（可选）排除结束日期，采用 ISO 8601 格式（YYYY-MM-DD）。如果省略，日历事件在与 `start` 相同的日期结束。
* `location`（可选，可重复）日历事件的位置。例如地址、GPS 坐标、会议室名称、视频通话链接
* `g`（可选）[geohash](https://en.wikipedia.org/wiki/Geohash) 用于将日历事件与可搜索的物理位置关联
* `p`（可选，可重复）参与者的 32 字节十六进制公钥，可选的推荐中继 URL，以及参与者在会议中的角色
* `t`（可选，可重复）用于分类日历事件的主题标签
* `r`（可选，可重复）引用/链接到网页、文档、视频通话、录制视频等

以下标签已弃用：
* `name` 日历事件的名称。仅在 `title` 不可用时使用。

```jsonc
{
  "id": <32字节小写十六进制编码的序列化事件数据的SHA-256>,
  "pubkey": <32字节小写十六进制编码的事件创建者公钥>,
  "created_at": <Unix时间戳（秒）>,
  "kind": 31922,
  "content": "<日历事件描述>",
  "tags": [
    ["d", "<UUID>"],

    ["title", "<日历事件标题>"],

    // 日期
    ["start", "<YYYY-MM-DD>"],
    ["end", "<YYYY-MM-DD>"],

    // 位置
    ["location", "<位置>"],
    ["g", "<geohash>"],

    // 参与者
    ["p", "<32字节十六进制公钥>", "<可选推荐中继URL>", "<角色>"],
    ["p", "<32字节十六进制公钥>", "<可选推荐中继URL>", "<角色>"],

    // 主题标签
    ["t", "<标签>"],
    ["t", "<标签>"],

    // 引用链接
    ["r", "<url>"],
    ["r", "<url>"]
  ]
}
```

### 基于时间的日历事件

这种日历事件跨越开始时间和结束时间之间。

#### 格式

该格式使用参数化可替换事件种类 `31923`。

这些事件的 `.content` 应该是日历事件的详细描述。它是必需的，但可以是空字符串。

标签列表如下：
* `d`（必需）通用唯一标识符（UUID）。由创建日历事件的客户端生成。
* `title`（必需）日历事件的标题
* `start`（必需）包含开始 Unix 时间戳（秒）。必须小于 `end`（如果存在）。
* `end`（可选）排除结束 Unix 时间戳（秒）。如果省略，日历事件瞬间结束。
* `start_tzid`（可选）开始时间戳的时区，由 IANA 时区数据库定义。例如，`America/Costa_Rica`
* `end_tzid`（可选）结束时间戳的时区，由 IANA 时区数据库定义。例如，`America/Costa_Rica`。如果省略且提供了 `start_tzid`，结束时间戳的时区与开始时间戳相同。
* `location`（可选，可重复）日历事件的位置。例如地址、GPS 坐标、会议室名称、视频通话链接
* `g`（可选）[geohash](https://en.wikipedia.org/wiki/Geohash) 用于将日历事件与可搜索的物理位置关联
* `p`（可选，可重复）参与者的 32 字节十六进制公钥，可选的推荐中继 URL，以及参与者在会议中的角色
* `t`（可选，可重复）用于分类日历事件的主题标签
* `r`（可选，可重复）引用/链接到网页、文档、视频通话、录制视频等

以下标签已弃用：
* `name` 日历事件的名称。仅在 `title` 不可用时使用。

```jsonc
{
  "id": <32字节小写十六进制编码的序列化事件数据的SHA-256>,
  "pubkey": <32字节小写十六进制编码的事件创建者公钥>,
  "created_at": <Unix时间戳（秒）>,
  "kind": 31923,
  "content": "<日历事件描述>",
  "tags": [
    ["d", "<UUID>"],

    ["title", "<日历事件标题>"],

    // 时间戳
    ["start", "<Unix时间戳（秒）>"],
    ["end", "<Unix时间戳（秒）>"],

    ["start_tzid", "<IANA时区数据库标识符>"],
    ["end_tzid", "<IANA时区数据库标识符>"],

    // 位置
    ["location", "<位置>"],
    ["g", "<geohash>"],

    // 参与者
    ["p", "<32字节十六进制公钥>", "<可选推荐中继URL>", "<角色>"],
    ["p", "<32字节十六进制公钥>", "<可选推荐中继URL>", "<角色>"],

    // 主题标签
    ["t", "<标签>"],
    ["t", "<标签>"],

    // 引用链接
    ["r", "<url>"],
    ["r", "<url>"]
  ]
}
```

## 日历

日历是日历事件的集合，表示为使用种类 `31924` 的自定义可替换列表事件。一个用户可以有多个日历。可以创建日历来为特定目的分类日历事件。例如，个人、工作、旅行、聚会和会议。

### 格式

这些事件的 `.content` 应该是日历的详细描述。它是必需的，但可以是空字符串。

该格式使用种类 `31924` 的自定义可替换列表，标签列表如下所述：
* `d`（必需）通用唯一标识符。由创建日历的客户端生成。
* `title`（必需）日历标题
* `a`（重复）引用标签，指向种类 `31922` 或 `31923` 的日历事件

```json
{
  "id": <32字节小写十六进制编码的序列化事件数据的SHA-256>,
  "pubkey": <32字节小写十六进制编码的事件创建者公钥>,
  "created_at": <Unix时间戳（秒）>,
  "kind": 31924,
  "content": "<日历描述>",
  "tags": [
    ["d", "<UUID>"],
    ["title", "<日历标题>"],
    ["a", "<31922或31923>:<日历事件作者公钥>:<日历事件的d标识符>", "<可选中继url>"],
    ["a", "<31922或31923>:<日历事件作者公钥>:<日历事件的d标识符>", "<可选中继url>"]
  ]
}
```

## 日历事件 RSVP

日历事件 RSVP 是对日历事件的回应，表示用户的出席意向。

如果日历事件标记了一个公钥，可以将其解释为日历事件创建者邀请该用户参加。客户端可以选择提示用户对日历事件进行 RSVP。

任何用户都可以进行 RSVP，即使他们没有在日历事件中被标记。客户端可以选择提示日历事件创建者邀请进行 RSVP 的用户。客户端也可以选择忽略这些 RSVP。

本 NIP 有意不定义未被标记的 RSVP 用户是否有权参加日历事件。这由日历事件创建者决定语义。

本 NIP 也有意不定义如果日历事件在提交 RSVP 后发生变化会发生什么。

### 格式

该格式使用参数化可替换事件种类 `31925`。

这些事件的 `.content` 是可选的，应该是一个自由格式的注释，为此日历事件响应添加更多上下文。

标签列表如下：
* `a`（必需）引用标签，指向被响应的种类 `31922` 或 `31923` 日历事件。
* `d`（必需）通用唯一标识符。由创建日历事件 RSVP 的客户端生成。
* `status`（必需）`accepted`、`declined` 或 `tentative`。确定对引用的日历事件的出席状态。
* `fb`（可选）`free` 或 `busy`。确定用户在日历事件期间是空闲还是忙碌。如果 `status` 标签设置为 `declined`，则必须省略或忽略此标签。

```json
{
  "id": <32字节小写十六进制编码的序列化事件数据的SHA-256>,
  "pubkey": <32字节小写十六进制编码的事件创建者公钥>,
  "created_at": <Unix时间戳（秒）>,
  "kind": 31925,
  "content": "<注释>",
  "tags": [
    ["a", "<31922或31923>:<日历事件作者公钥>:<日历事件的d标识符>", "<可选中继url>"],
    ["d", "<UUID>"],
    ["status", "<accepted/declined/tentative>"],
    ["fb", "<free/busy>"],
  ]
}
```

## 未解决的限制

* 没有私密事件

## 有意不支持的场景

### 重复日历事件

重复日历事件带来了很多复杂性，使软件和人类难以处理。这种复杂性包括邀请者之间的时区差异、夏令时、闰年、多个日历系统、日程或其他元数据的一次性更改等。

本 NIP 有意不支持重复日历事件，并将这种复杂性推给客户端，如果他们希望的话可以手动实现。即，具有重复元数据的单个日历事件代表重复日历事件。