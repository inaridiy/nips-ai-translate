---
original: 0197c51a10e973db8983eb69375630b4a55b34fa74bcf484945cae32abc545cb
---

NIP-65
======

中继列表元数据
--------------

`草案` `可选`

定义了一个使用 `kind:10002` 的可替换事件，用于公布用户首选的中继，以便发现用户的内容和接收来自他人的新内容。

该事件必须包含一个带有中继 URI 和 `read` 或 `write` 标记的 `r` 标签列表。标记为 `read` / `write` 的中继分别称为读取 / 写入中继。如果省略标记，则该中继用于两种用途。

`.content` 不使用。

```json
{
  "kind": 10002,
  "tags": [
    ["r", "wss://alicerelay.example.com"],
    ["r", "wss://brando-relay.com"],
    ["r", "wss://expensive-relay.example2.com", "write"],
    ["r", "wss://nostr-relay.example.com", "read"]
  ],
  "content": "",
  ...其他字段
}
```

本 NIP 并不完全替代旨在配置客户端使用中继的中继列表（如 `kind:3` 样式的中继列表）。在无法找到 `kind:10002` 中继列表的情况下，客户端可以使用其他中继列表。

## 何时使用读取和写入中继

当寻找来自用户的事件时，客户端应使用该用户 `kind:10002` 中的写入中继。

当寻找关于用户的事件（用户被标记的事件）时，客户端应使用该用户 `kind:10002` 中的读取中继。

在广播事件时，客户端应：

- 将事件广播到作者的写入中继
- 将事件广播到每个被标记用户的所有读取中继

## 动机

使用固定的每用户中继列表的旧模型导致大型中继运营商的中心化：

  - 大多数用户将他们的帖子提交到同样受欢迎的中继，目的是在更广泛的受众中获得更大的可见性
  - 许多用户从大量中继中拉取事件，以获取更多数据，但代价是重复
  - 事件在中继之间被复制，通常复制到许多不同的中继

本 NIP 允许客户端直接连接到每个用户最新的中继集，消除了向热门中继广播事件的需求。

## 最终考虑

1. 客户端应引导用户保持 `kind:10002` 列表较小（2-4个中继）。

2. 客户端应尽可能将作者的 `kind:10002` 事件传播到更多的中继。

3. `kind:10002` 事件主要用于向他人公布用户首选的中继。用户自己的客户端可能使用其他启发式方法来选择用于获取数据的中继。

4. 直接消息（DM）应只广播到作者的写入中继和接收者的读取中继，以保持最大隐私。

5. 如果中继在其 [NIP-11](11.md) 文档中表示支持本 NIP，这意味着他们愿意接受来自广泛用户的 kind 10002 事件，而不仅仅是他们的付费客户或白名单组。

6. 客户端应根据 [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986#section-6) 对中继 URI 进行规范化，以消除重复连接。