---
original: 7bb76f2ea1d6f1fc4ec31db21e5236e0d6947981ecdad88f1e46a1c83369a4a8
---

NIP-54
======

维基
----

`草案` `可选`

本NIP定义了`kind:30818`（一种_参数化可替换事件_），用于类似于[NIP-23](23.md)的长篇文本内容，但有一个重要区别：文章旨在描述或作为特定主题的百科全书条目，预计多人会就完全相同的主题撰写文章，可能有细微变化或完全独立的内容。

文章通过小写、规范化的ASCII `d`标签进行识别。

### 文章
```jsonc
{
  "content": "维基是一种由其受众协作编辑和管理的超文本出版物。",
  "tags": [
    ["d", "wiki"],
    ["title", "维基"],
  ]
}
```

### `d`标签规范化规则

- 任何非字母字符必须转换为`-`。
- 所有字母必须转换为小写。

### 内容规则

内容应为Markdown格式，遵循与[NIP-23](23.md)相同的规则，但增加了一些额外的（可选）元数据标签：

  - `title`：用于显示标题与`d`标签不同的情况。
  - `summary`：用于在列表中显示。
  - `a`和`e`：用于引用维基文章分叉自的原始事件。

增加了一个额外功能：**维基链接**。与链接到网页的普通Markdown链接`[]()`不同，维基链接`[[]]`链接到维基中的其他文章。在这种情况下，维基是整个Nostr。点击维基链接应导致客户端向中继请求具有与该维基链接目标相等的`d`标签的事件。

维基链接可以采用以下两种形式：

  1. `[[目标页面]]` -- 在这种情况下，它将链接到页面`目标页面`（根据上述`d`标签规范化规则），并显示为`目标页面`；
  2. `[[目标页面|查看此处]]` -- 在这种情况下，它将链接到页面`目标页面`，但将显示为`查看此处`。

### 合并请求

事件`kind:818`表示从分叉文章合并到源文章的请求。它针对一个公钥，并引用原始文章和修改后的事件。

[插入事件示例]

### 重定向

事件`kind:30819`也被定义为"维基重定向"，即如果有人认为`Shell structure`应重定向到`Thin-shell structure`，他们可以发出这些事件之一，而不是复制内容。这些事件可用于客户端上的文章自动重定向，也可用于生成众包的"消歧义"页面（[在维基百科中很常见](https://en.wikipedia.org/wiki/Help:Disambiguation)）。

[插入事件示例]

如何决定显示哪篇文章
-------------------------------------

由于每个给定名称可能有多篇文章，客户端必须进行某种优先级排序。这些标准应因用户和客户端而异，但下面描述了一些可以使用的方法：

### 反应

[NIP-25](25.md)反应非常简单，可用于在维基文章作者及其内容之间创建简单的信任网络。虽然仅计算原始"赞"数量是无效的，但对任何维基文章事件用`+`反应可以被解释为对该特定文章的推荐，以及对该文章作者的部分推荐。当遵循2或3级深度的推荐时，突然间所有文章的很大一部分可能都有某种形式的标记。

### 中继

[NIP-51](51.md)中继列表可以使用kind 10102创建，然后由维基客户端使用，以确定首先查询文章的位置，并相对于从其他中继获取的其他事件对这些文章进行排名。

### 联系人列表

[NIP-02](02.md)联系人列表可以形成推荐系统的基础，然后通过嵌套查询扩展为中继列表和反应列表。这些列表之所以成为良好的起点，仅仅是因为它们非常普遍。

### 与维基相关的联系人列表

[NIP-51](51.md)列表也可用于创建仅在维基作者或维基策展人上下文中受信任的用户列表。

分叉
---------
维基事件可以用`fork`标记标记其他维基事件，以指定该事件来自不同版本。应使用`a`和`e`标签，并应用`fork`标记，以识别它分叉自的确切版本。

尊重
---------
维基事件可以用`defer`标记标记其他维基事件，以表明它认为其他人的条目是自己的"更好"版本。如果使用`defer`标记，应同时使用`a`和`e`标签。

这比`+`反应是一个更强的信任信号。

当用户编辑他人的条目时，这个标记很有用；如果原作者包含了编辑者的更改，而编辑者不想保留/维护独立版本，则`link`标签实际上可以被视为编辑者版本的"删除"，并将该公钥的WoT权重放在原作者版本之后。

为什么选择Markdown？
-------------

如果想要制作维基，那么最明显的文本格式可能是维基百科使用的mediawiki/wikitext格式，因为它在所有mediawiki安装中广泛部署，并且多年来取得了巨大成功。然而，事实证明，该格式非常臃肿和复杂，功能过多，可能正因为如此，没有许多替代实现，而现有的实现也不完整，看起来不太可靠。此外，它是一种非常集中的格式，可能会随维基百科所有者的意愿而改变。

另一方面，Markdown已被证明适用于小规模维基，而且地球上最大的维基之一（通常不被认为是维基）[StackOverflow](https://stackoverflow.com)及其子站点，以及最大的"个人维基"软件之一[Obsidian](https://obsidian.md/)也使用Markdown。Markdown可能能提供wikitext 95%的功能。当增加表格、图表生成器和MathJax（这些是常见的扩展，可以包含在本NIP中）时，这个比率可能达到99%，而且它的简单性是一个不可忽视的巨大优势。Wikitext格式也可以使用Pandoc转译为Markdown。考虑到这一切，我认为有理由怀疑mediawiki并不比Markdown本质上更好，维基百科的成功可能不能归因于语法语言的选择。

# 附录1：合并请求
用户可以通过创建`kind:818`事件来请求其他用户将他们的条目合并到其他人的条目中。

```jsonc
{
  "content": "我添加了关于如何制作热冰淇淋的信息",
  "kind": 818,
  "tags": [
    [ "a", "30818:<destination-pubkey>:hot-ice-creams", "<relay-url>" ],
    [ "e", "<version-against-which-the-modification-was-made>", "<relay-url>' ],
    [ "p", "<destination-pubkey>" ],
    [ "e", "<version-to-be-merged>", "<relay-url>", "source" ]
  ]
}
```

`.content`：可选的解释，详细说明为什么请求此合并。
`a`标签：应修改的文章标签（即此合并请求的目标）。
`e`标签：基于此修改的文章可选版本
带有`source`标记的`e`标签：应合并的事件ID。此事件ID必须是本NIP中定义的`kind:30818`。

目标公钥（被请求将某些内容合并到其文章中的公钥）可以创建[[NIP-25]]反应，用`+`或`-`标记`kind:818`事件