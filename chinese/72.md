---
original: 3f6cc15fdd38fc5243e2c069df5bc637239ec9b896257a24f851901f4368842d
---

NIP-72
======

管理社区（类似 Reddit 风格）
------------------------------------

`草案` `可选`

本 NIP 的目标是实现公共社区。它定义了可替换事件 `kind:34550` 来定义社区和当前的管理员/管理员列表。想要在社区发帖的用户只需用社区的 `a` 标签标记任何 Nostr 事件。管理员可以发布 `kind:4550` 的批准事件。

# 社区定义

`Kind:34550` 应包含任何有助于定义社区和管理员集合的字段。`relay` 标签可用于描述下载请求和批准的首选中继。社区定义事件的 `d` 标签可以兼作其名称，但如果提供了 `name` 标签，则应显示 `name` 标签而不是 `d` 标签。

```jsonc
{
  "created_at": <Unix 时间戳（秒）>,
  "kind": 34550,
  "tags": [
    ["d", "<community-d-identifier>"],
    ["name", "<社区名称>"],
    ["description", "<社区描述>"],
    ["image", "<社区图片 URL>", "<宽度>x<高度>"],

    //.. 其他与定义社区相关的标签

    // 管理员
    ["p", "<pubkey1 的 32 字节十六进制>", "<可选推荐中继 URL>", "moderator"],
    ["p", "<pubkey2 的 32 字节十六进制>", "<可选推荐中继 URL>", "moderator"],
    ["p", "<pubkey3 的 32 字节十六进制>", "<可选推荐中继 URL>", "moderator"],

    // 社区使用的中继（带可选标记）
    ["relay", "<托管作者 kind 0 的中继>", "author"],
    ["relay", "<发送和接收请求的中继>", "requests"],
    ["relay", "<发送和接收批准的中继>", "approvals"],
    ["relay", "<发布请求和获取批准的中继>"]
  ],
  ...
}
```

# 在社区发帖

任何 Nostr 事件都可以发布到社区。客户端必须添加一个或多个社区 `a` 标签，每个标签都有一个推荐的中继。

```jsonc
{
  "kind": 1,
  "tags": [
    ["a", "34550:<社区事件作者公钥>:<community-d-identifier>", "<可选中继 URL>"],
  ],
  "content": "你好，世界",
  // ...
}
```

# 管理

任何人都可以发布批准事件，表达他们认为某个帖子适合社区的观点。客户端可以选择接受哪些批准事件，但至少应该使用由群组定义的管理员发布的批准事件。

批准事件必须包含一个或多个社区 `a` 标签，一个指向帖子的 `e` 或 `a` 标签，以及帖子作者的 `p` 标签（用于批准通知）。可以使用 `a` 标签前缀来区分社区和可替换事件指针（社区 `a` 标签总是以 `34550` 开头）。

事件还应在 `.content` 中包含 JSON 字符串化的 `post request` 事件，以及带有原始帖子事件类型的 `k` 标签，以允许按类型筛选已批准的帖子。

管理员可以随时使用 NIP 09 事件删除来删除他们对帖子的批准。

```jsonc
{
  "pubkey": "<事件创建者的 32 字节小写十六进制编码公钥>",
  "kind": 4550,
  "tags": [
    ["a", "34550:<事件作者公钥>:<community-d-identifier>", "<可选中继 URL>"],
    ["e", "<帖子 ID>", "<可选中继 URL>"],
    ["p", "<帖子作者公钥>", "<可选中继 URL>"],
    ["k", "<帖子请求类型>"]
  ],
  "content": "<完整的已批准事件，JSON 编码>",
  // ...
}
```

建议多个管理员批准帖子，以避免在管理员从所有者列表中删除时从社区中删除帖子。如果必须轮换完整的管理员列表，新的管理员集必须为过去的帖子签署新的批准，否则社区将重新启动。所有者还可以定期复制并重新签署每个管理员的批准事件，以确保帖子不会随管理员消失。

可替换事件的批准可以通过三种方式创建：

1. 如果管理员想要批准可替换事件的每个单独更改，则将可替换事件标记为 `e` 标签
2. 如果管理员授权可替换事件作者在不需要额外批准的情况下进行更改，则将可替换事件标记为 `a` 标签
3. 将可替换事件同时标记为 `e` 和 `a` 标签，这使客户端能够显示事件的原始版本和更新版本，并在用户界面中适当标注

由于中继被指示删除可替换事件的旧版本，使用 `e` 标签的批准的 `content` 必须包含事件的特定版本，否则客户端可能无法在任何地方找到该版本的内容。

客户端应将任何非 `34550:*` `a` 标签评估为需要为所有 `34550:*` `a` 标签批准的帖子。

# 跨社区发帖

客户端可以通过使用上述描述的 `a` 标签将 NIP 18 `kind 6` 或 `kind 16` 转发帖子到一个或多个社区来支持跨社区发帖。转发的 `content` 必须是原始事件，而不是批准事件。