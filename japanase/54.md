---
original: 7bb76f2ea1d6f1fc4ec31db21e5236e0d6947981ecdad88f1e46a1c83369a4a8
---

NIP-54
======

ウィキ
----

`draft` `optional`

このNIPは、[NIP-23](23.md)と同様の長文テキストコンテンツのための`kind:30818`（_パラメータ化された置換可能イベント_）を定義しますが、重要な違いがあります：記事は特定の主題の説明や百科事典的な項目を意図しており、複数の人々が全く同じ主題について、わずかな違いや完全に独立したコンテンツで記事を書くことが期待されています。

記事は小文字の、正規化されたASCIIの`d`タグによって識別されます。

### 記事
```jsonc
{
  "content": "ウィキは、その読者自身によって共同で編集・管理されるハイパーテキスト出版物です。",
  "tags": [
    ["d", "wiki"],
    ["title", "ウィキ"],
  ]
}
```

### `d`タグの正規化ルール

- 文字以外の文字はすべて`-`に変換しなければなりません。
- すべての文字は小文字に変換しなければなりません。

### コンテンツルール

コンテンツは[NIP-23](23.md)と同じルールに従うMarkdownであるべきですが、いくつかの追加の（オプションの）メタデータタグがあります：

  - `title`: 表示タイトルが`d`タグと異なる場合に使用します。
  - `summary`: リストでの表示用。
  - `a`と`e`: ウィキ記事が派生元のオリジナルイベントを参照するために使用します。

追加機能として、**ウィキリンク**があります。通常のMarkdownリンク`[]()`がウェブページにリンクするのとは異なり、ウィキリンク`[[]]`はウィキ内の他の記事にリンクします。この場合、ウィキはNostr全体を指します。ウィキリンクをクリックすると、クライアントはそのウィキリンクのターゲットに等しい`d`タグを持つイベントをリレーに要求するはずです。

ウィキリンクは以下の2つの形式を取ることができます：

  1. `[[ターゲットページ]]` -- この場合、`target-page`（上記の`d`タグ正規化ルールに従って）にリンクし、`ターゲットページ`として表示されます。
  2. `[[target page|これを見てください]]` -- この場合、`target-page`にリンクしますが、`これを見てください`として表示されます。

### マージリクエスト

イベント`kind:818`は、派生した記事からソースへのマージリクエストを表します。これは公開鍵に向けられ、オリジナルの記事と修正されたイベントを参照します。

[イベント例を挿入]

### リダイレクト

イベント`kind:30819`も「ウィキリダイレクト」を表すものとして定義されています。例えば、`Shell structure`が`Thin-shell structure`にリダイレクトすべきだと考える場合、コンテンツを複製する代わりにこれらのイベントの1つを発行できます。これらのイベントは、クライアント上で記事間を自動的にリダイレクトするために使用できますが、クラウドソーシングによる「曖昧さ回避」ページ（[Wikipediaでよく見られる](https://en.wikipedia.org/wiki/Help:Disambiguation)）を生成するためにも使用できます。

[イベント例を挿入]

どの記事を表示するかを決定する方法
-------------------------------------

各名前に対して多くの記事が存在する可能性があるため、クライアントによる何らかの優先順位付けが必要です。この基準はユーザーやクライアントによって異なるべきですが、以下に使用可能な手段をいくつか説明します：

### リアクション

[NIP-25](25.md)のリアクションは非常にシンプルで、ウィキ記事作成者とそのコンテンツの間に簡単な信頼のウェブを作成するために使用できます。単純に「いいね」の数を数えるだけでは生産的ではありませんが、ウィキ記事イベントに`+`でリアクションすることは、その記事への推奨と、その記事の著者への部分的な推奨として解釈できます。2〜3レベルの深さの推奨をたどると、突然、すべての記事の大部分が何らかの形でタグ付けされる可能性があります。

### リレー

[NIP-51](51.md)のリレーリストはkind 10102で作成でき、ウィキクライアントが記事を最初に問い合わせる場所を決定し、他のリレーから取得した他のイベントとの関係で異なるランク付けをするために使用できます。

### コンタクトリスト

[NIP-02](02.md)のコンタクトリストは、ネストされたクエリを通じてリレーリストとリアクションリストで拡張される推奨システムの基礎を形成できます。これらのリストは、非常に広く普及しているため、良い出発点となります。

### ウィキ関連のコンタクトリスト

[NIP-51](51.md)のリストは、ウィキの著者性やウィキのキュレーターシップのコンテキストでのみ信頼されるユーザーのリストを作成するためにも使用できます。

フォーク
---------
ウィキイベントは、このイベントが異なるバージョンから派生したことを指定するために、`fork`マーカーを持つ他のウィキイベントをタグ付けできます。フォーク元の正確なバージョンを識別するために、`a`タグと`e`タグの両方を使用し、`fork`マーカーを適用すべきです。

譲渡
---------
ウィキイベントは、他の誰かのエントリーを「より良い」バージョンとみなすことを示すために、`defer`マーカーを持つ他のウィキイベントをタグ付けできます。`defer`マーカーを使用する場合、`a`タグと`e`タグの両方を使用すべきです。

これは`+`リアクションよりも強い信頼のシグナルです。

このマーカーは、ユーザーが他の人のエントリーを編集する場合に役立ちます。オリジナルの著者が編集者の変更を取り込み、編集者が独立したバージョンを維持したくない場合、`link`タグは事実上、編集者のバージョンの「削除」とみなすことができ、その公開鍵のWoT（信頼のウェブ）の重みをオリジナルの著者のバージョンに置くことができます。

なぜMarkdownなのか？
-------------

ウィキを作るという考えであれば、おそらく最も明白なテキスト形式はWikipediaで使用されているmediawiki/wikitextフォーマットでしょう。これは、すべてのmediawikiインストールで広く展開され、何十年にもわたって大きな成功を収めて使用されてきました。しかし、このフォーマットは非常に冗長で複雑であり、機能が多すぎるため、おそらくそのために代替の実装があまり存在せず、存在するものも完全ではなく、あまり信頼できるようには見えません。また、これは非常に中央集権的なフォーマットであり、おそらくWikipediaの所有者の気まぐれで変更される可能性があります。

一方、Markdownは小規模なウィキでうまく機能することが証明されており、地球上で最大のウィキの1つ（ウィキとしてあまり考えられていない）である[StackOverflow](https://stackoverflow.com)とその子サイト、また最大の「個人ウィキ」ソフトウェアの1つである[Obsidian](https://obsidian.md/)でも使用されています。Markdownはおそらくwikitextの機能の95%を提供できます。表、ダイアグラムジェネレーター、MathJax（これらは一般的な拡張機能であり、このNIPに含めることができます）で拡張すると、その割合はおそらく99%になり、その単純さは見過ごせない大きな利点です。wikitextフォーマットもPandocを使用してMarkdownに変換できます。これらすべてを考慮すると、mediawikiが本質的にMarkdownよりも優れているとは言えず、Wikipediaの成功は構文言語の選択に基づいているわけではないと合理的に推測できます。

# 付録1：マージリクエスト
ユーザーは`kind:818`イベントを作成することで、他のユーザーに自分のエントリーを他の人のエントリーにマージするよう要求できます。

```jsonc
{
  "content": "ホットアイスクリームの作り方に関する情報を追加しました",
  "kind": 818,
  "tags": [
    [ "a", "30818:<destination-pubkey>:hot-ice-creams", "<relay-url>" ],
    [ "e", "<version-against-which-the-modification-was-made>", "<relay-url>' ],
    [ "p", "<destination-pubkey>" ],
    [ "e", "<version-to-be-merged>", "<relay-url>", "source" ]
  ]
}
```

`.content`: このマージが要求される理由を詳細に説明するオプションのテキスト。
`a`タグ: 修正されるべき記事のタグ（つまり、このマージリクエストのターゲット）。
`e`タグ: この修正が基づいている記事のオプションのバージョン。
`source`マーカー付きの`e`タグ: マージされるべきイベントのID。このイベントIDは、このNIPで定義されている`kind:30818`でなければなりません。

マージ先の公開鍵（自分の記事に何かをマージするよう要求されている公開鍵）は、[[NIP-25]]リアクションを作成して`kind:818`イベントを`+`または`-`でタグ付けできます。