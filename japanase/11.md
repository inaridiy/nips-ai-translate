---
original: e805e4561a1ff8c84bc4ba8022c3c1659688a114aeda1efd9ddd313e9ef3f19e
---

NIP-11
======

リレー情報ドキュメント
---------------------------

`draft` `optional`

リレーは、機能、管理者連絡先、および様々なサーバー属性についてクライアントに通知するために、サーバーメタデータを提供することができます。これは、リレーのウェブソケットと同じURIで、HTTPを介してJSONドキュメントとして利用可能です。

リレーがWebSocketアップグレードをサポートするURIに対して、`Accept`ヘッダーが`application/nostr+json`のHTTP(s)リクエストを受信した場合、以下の構造のドキュメントを返すべきです（SHOULD）。

```json
{
  "name": <リレーを識別する文字列>,
  "description": <詳細情報を含む文字列>,
  "pubkey": <管理者連絡先の公開鍵>,
  "contact": <管理者の代替連絡先>,
  "supported_nips": <リレーがサポートするNIP番号のリスト>,
  "software": <リレーソフトウェアのURLを識別する文字列>,
  "version": <バージョン識別子の文字列>
}
```

任意のフィールドを省略することができ、クライアントは理解できない追加のフィールドを無視しなければなりません（MUST）。リレーは、`Access-Control-Allow-Origin`、`Access-Control-Allow-Headers`、および`Access-Control-Allow-Methods`ヘッダーを送信することで、CORSリクエストを受け入れなければなりません（MUST）。

フィールドの説明
------------------

### 名前

リレーは、クライアントソフトウェアで使用する`name`を選択することができます。これは文字列であり、クライアントによる切り捨てを避けるため、30文字未満であるべきです（SHOULD）。

### 説明

リレーに関する詳細なプレーンテキスト情報は、`description`文字列に含めることができます。マークアップ、フォーマット、または改行を含まず、段落を区切るために単に二重の改行文字を使用することが推奨されます。長さに制限はありません。

### 公開鍵

管理者連絡先は、Nostrイベントと同じ形式（`secp256k1`公開鍵の32バイト16進数）で`pubkey`としてリストできます。連絡先がリストされている場合、これはクライアントにシステム管理者に暗号化された直接メッセージ（[NIP-17](17.md)参照）を送信するための推奨アドレスを提供します。このアドレスの想定される使用目的は、乱用や違法コンテンツの報告、バグレポートの提出、またはその他の技術的支援の要請です。

リレー運営者には、直接メッセージに応答する義務はありません。

### 連絡先

`pubkey`と同じ目的で、`contact`フィールドの下に代替連絡先をリストすることもできます。Nostr公開鍵と直接メッセージの使用が、これよりも優先されるべきです（SHOULD）。このフィールドの内容は、`mailto`や`https`などのスキームを使用してユーザーに連絡手段を提供するURIであるべきです（SHOULD）。

### サポートされているNIP

Nostrプロトコルが進化するにつれて、一部の機能は特定の`NIP`を実装しているリレーでのみ利用可能になる場合があります。このフィールドは、リレーで実装されている`NIP`の整数識別子の配列です。例えば、`"NIP-01"`の場合は`1`、`"NIP-09"`の場合は`9`などです。クライアント側の`NIP`は広告されるべきではなく（SHOULD NOT）、クライアントによって無視できます。

### ソフトウェア

リレーサーバーの実装は、`software`属性で提供される場合があります（MAY）。存在する場合、これはプロジェクトのホームページへのURLでなければなりません（MUST）。

### バージョン

リレーは、ソフトウェアバージョンを文字列属性として公開することを選択できます（MAY）。文字列形式はリレー実装によって定義されます。バージョン番号またはコミット識別子であることが推奨されます。

追加フィールド
------------

### サーバーの制限

これらは、リレーがクライアントに課す制限です。クライアントは、これらの*実用的な*制限を超えるリクエストが即座に拒否されるか失敗することを想定すべきです。

```json
{
  "limitation": {
    "max_message_length": 16384,
    "max_subscriptions": 20,
    "max_filters": 100,
    "max_limit": 5000,
    "max_subid_length": 100,
    "max_event_tags": 100,
    "max_content_length": 8196,
    "min_pow_difficulty": 30,
    "auth_required": true,
    "payment_required": true,
    "restricted_writes": true,
    "created_at_lower_limit": 31536000,
    "created_at_upper_limit": 3
  },
  ...
}
```

- `max_message_length`: リレーがデコードして処理を試みる着信JSONの最大バイト数です。大きな購読を送信する場合、この値によって制限されます。また、これは事実上、任意のイベントの最大サイズも制限します。値は`[`から`]`まで計算され、UTF-8シリアル化後のものです（一部のユニコード文字は2〜3バイトを消費します）。これはWebSocketメッセージフレームの最大サイズと等しくなります。

- `max_subscriptions`: 単一のWebSocket接続でこのリレーにアクティブにできる購読の総数です。認証されたクライアントや、リレーとの（有料の）関係を持つクライアントは、より高い制限を持つ可能性があります。

- `max_filters`: 各購読のフィルター値の最大数です。1以上でなければなりません。

- `max_subid_length`: 購読IDの文字列としての最大長です。

- `max_limit`: リレーサーバーは各フィルターの`limit`値をこの数値に制限します。これは、クライアントが単一の購読フィルターからこの数以上のイベントを取得できないことを意味します。この制限は通常、リレーによって暗黙的に行われますが、この数値を知ることで、フィルターの時間範囲やその他のパラメータを絞り込めば追加の結果があることがわかります。

- `max_event_tags`: 任意のイベントにおいて、`tags`リストの最大要素数です。

- `max_content_length`: 任意のイベントの`content`フィールドの最大文字数です。これはユニコード文字のカウントです。JSONにシリアル化した後、（バイト単位で）より大きくなる可能性があり、定義されている場合は`max_message_length`の制限も受けます。

- `min_pow_difficulty`: 新しいイベントには、[NIP-13](13.md)に基づいて、少なくともこの難易度のPoWが必要となり、そうでない場合はこのサーバーによって拒否されます。

- `auth_required`: このリレーは、新しい接続が他のアクションを実行する前に[NIP-42](42.md)認証が行われることを要求します。Falseに設定されていても、特定のアクションに対して認証が必要になる場合があります。

- `payment_required`: このリレーは、新しい接続が任意のアクションを実行する前に支払いを要求します。

- `restricted_writes`: このリレーは、イベントを受け入れるために何らかの条件が満たされることを要求します（必ずしも`payment_required`や`min_pow_difficulty`に限りません）。これは、ユーザーがリレーに書き込もうとする前にリレーポリシーを知っていることが期待される場合にのみ`true`に設定されるべきです - 特別な公開鍵ベースのホワイトリストに属しているか、特定のニッチな種類やコンテンツのイベントのみを書き込むなどです。例えば、通常のアンチスパムヒューリスティクスは該当しません。

- `created_at_lower_limit`: 'created_at'の下限

- `created_at_upper_limit`: 'created_at'の上限

### イベントの保持

データを永久に保存することには費用が関連する可能性があるため、リレーは保持期間を述べたいかもしれません。ここで述べられる値は、認証されていないユーザーと訪問者のデフォルトです。有料ユーザーは、おそらく他のポリシーを持つでしょう。

保持時間は秒単位で与えられ、`null`は無限を示します。ゼロが提供された場合、これはイベントが全く保存されないことを意味し、できればそれらが受信されたときにエラーが提供されます。

```json
{
  "retention": [
    {"kinds": [0, 1, [5, 7], [40, 49]], "time": 3600},
    {"kinds": [[40000, 49999]], "time": 100},
    {"kinds": [[30000, 39999]], "count": 1000},
    {"time": 3600, "count": 10000}
  ]
}
```

`retention`は仕様のリストです：各仕様は、すべての種類、または種類のサブセットに適用されます。種類フィールドの範囲は、包括的な開始値と終了値のタプルとして指定できます。指定された種類（またはすべて）のイベントは、その後、`count`および/または時間期間に制限されます。

特定の`kind`番号に依存するNostrベースのプロトコルを効果的にブラックリストに登録することが可能です。これらの`kind`値に対して保持時間をゼロに設定することで実現できます。これは残念ですが、単一のHTTPフェッチを通じて、クライアントがそのプロトコルをサポートするサーバーを迅速に発見できるようにします。

_一時的なイベント_については保持時間を指定する必要はありません。なぜなら、それらは保持されないからです。

### コンテンツの制限

一部のリレーは、国家の恣意的な法律によって管理されている場合があります。これにより、それらのリレーに平文で保存できるコンテンツが制限される可能性があります。すべてのクライアントは、この制限を回避するために暗号化を使用することが推奨されます。

各国の法律や政策の制限を説明することは不可能です。それらは通常、曖昧で常に変化しています。

したがって、このフィールドでは、リレー運営者が、どの国の法律が彼らに、そして間接的にユーザーのコンテンツに適用される可能性があるかを示すことができます。

ユーザーは、好まない国のリレーを避けたり、より好ましいゾーンのリレーを選択したりできるはずです。この柔軟性の公開はクライアントソフトウェア次第です。

```json
{
  "relay_countries": [ "CA", "US" ],
  ...
}
```

- `relay_countries`: このリレーに影響を与える可能性のある法律や政策を持つ国の2レベルISOカントリーコード（ISO 3166-1 alpha-2）のリストです。欧州連合諸国には`EU`を使用できます。

リレーがホストされている国が、リレーを所有する法人の国ではない可能性があることを覚えておいてください。そのため、多数の国が関与している可能性が非常に高いです。

### コミュニティの設定

少なくとも公開テキストノートについては、リレーはローカルコミュニティを育成しようとする場合があります。これにより、ユーザーが通常の個別のフォローに加えて、そのリレーのグローバルフィードをフォローすることが奨励されます。この目標をサポートするために、リレーは以下の値のいくつかを指定することができます（MAY）。

```json
{
  "language_tags": ["en", "en-419"],
  "tags": ["sfw-only", "bitcoin-only", "anime"],
  "posting_policy": "https://example.com/posting-policy.html",
  ...
}
```

- `language_tags`は、リレーで話される主要な言語を示す[IETF言語タグ](https://en.wikipedia.org/wiki/IETF_language_tag)の順序付きリストです。

- `tags`は、議論されるトピックの制限のリストです。例えば、`sfw-only`は、このリレーでは「職場で安全」なコンテンツのみが奨励されることを示します。これは、「職場」「コミュニティ」が「安全」だと感じる話題についての仮定に依存します。時間とともに、ユーザーがニーズに合ったリレーを見つけることができる共通のタグセットが現れる可能性があり、クライアントソフトウェアはこれらのタグを簡単に解析できるようになるでしょう。`bitcoin-only`タグは、*アルトコイン*、*「暗
号資産」*や*ブロックチェーン*に関するコメントが容赦なく批判されることを示します。

- `posting_policy`は、リレーのコミュニティポリシーを指定する人間が読める形式のページへのリンクです。`sfw-only`がTrueの場合、投稿ポリシーの詳細を記載したページにリンクすることが重要です。

`description`フィールドは、コミュニティの目標と価値観を簡潔に説明するために使用すべきです。`posting_policy`は追加の詳細と法的条件のためのものです。`tags`フィールドを使用して、コンテンツの制限や議論されるトピックを示し、適切なクライアントソフトウェアによって機械処理できるようにします。

### 有料リレー

支払いを要求するリレーは、料金スケジュールを公開したい場合があります。

```json
{
  "payments_url": "https://my-relay/payments",
  "fees": {
    "admission": [{ "amount": 1000000, "unit": "msats" }],
    "subscription": [{ "amount": 5000000, "unit": "msats", "period": 2592000 }],
    "publication": [{ "kinds": [4], "amount": 100, "unit": "msats" }],
  },
  ...
}
```

### アイコン

リレーのアイコンとして使用する画像を指すURL。正方形の形状が推奨されます。

```json
{
  "icon": "https://nostr.build/i/53866b44135a27d624e99c6165cabd76ac8f72797209700acb189fce75021f47.jpg",
  ...
}
```

### 例

2023年5月2日現在、以下のコマンドは次の結果を提供しました：

```
~> curl -H "Accept: application/nostr+json" https://eden.nostr.land | jq

{
  "description": "nostr.landリレーファミリー (us-or-01)",
  "name": "nostr.land",
  "pubkey": "52b4a076bcbbbdc3a1aefa3735816cf74993b1b8db202b01c883c58be7fad8bd",
  "software": "custom",
  "supported_nips": [
    1,
    2,
    4,
    9,
    11,
    12,
    16,
    20,
    22,
    28,
    33,
    40
  ],
  "version": "1.0.1",
  "limitation": {
    "payment_required": true,
    "max_message_length": 65535,
    "max_event_tags": 2000,
    "max_subscriptions": 20,
    "auth_required": false
  },
  "payments_url": "https://eden.nostr.land",
  "fees": {
    "subscription": [
      {
        "amount": 2500000,
        "unit": "msats",
        "period": 2592000
      }
    ]
  },
}
```